{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AsyncTypeaheadField = exports.TypeaheadField = undefined;\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nexports.mapToSchema = mapToSchema;\nexports.mapFromSchema = mapFromSchema;\nexports.toSelected = toSelected;\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactBootstrapTypeahead = require(\"react-bootstrap-typeahead\");\n\nvar _utils = require(\"./utils\");\n\nvar _selectn = require(\"selectn\");\n\nvar _selectn2 = _interopRequireDefault(_selectn);\n\nvar _Label = require(\"./Label\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar DEFAULT_OPTIONS = {\n  required: false,\n  labelKey: \"name\",\n  minLength: 3,\n  placeholder: \"Search...\",\n  ref: \"typeahead\"\n};\n\nfunction optionToString(fields, separator) {\n  return function (option) {\n    return fields.map(function (field) {\n      return (0, _selectn2.default)(field, option);\n    }).filter(function (fieldVal) {\n      return fieldVal;\n    }).reduce(function (agg, fieldVal, i) {\n      if (i === 0) {\n        return fieldVal;\n      } else {\n        if (Array.isArray(separator)) {\n          return \"\" + agg + separator[i - 1] + fieldVal;\n        }\n\n        return \"\" + agg + separator + fieldVal;\n      }\n    }, \"\");\n  };\n}\n\nfunction mapLabelKey(labelKey) {\n  if (Array.isArray(labelKey)) {\n    return optionToString(labelKey, \" \");\n  } else if ((typeof labelKey === \"undefined\" ? \"undefined\" : _typeof(labelKey)) === \"object\" && labelKey.fields && labelKey.separator) {\n    var fields = labelKey.fields,\n        separator = labelKey.separator;\n    return optionToString(fields, separator);\n  }\n\n  return labelKey;\n}\n\nfunction defaultValue(properties) {\n  var defVal = Object.keys(properties).reduce(function (agg, field) {\n    if (properties[field].default !== undefined) {\n      agg[field] = properties[field].default;\n    }\n\n    return agg;\n  }, {});\n  return defVal;\n}\n\nfunction mapToObject(event, mapping, defVal) {\n  var schemaEvent = Object.keys(mapping).reduce(function (agg, field) {\n    var eventField = mapping[field];\n\n    if ((typeof eventField === \"undefined\" ? \"undefined\" : _typeof(eventField)) === \"object\") {\n      agg[field] = mapToObject(event, eventField, {});\n    } else {\n      agg[field] = (0, _selectn2.default)(eventField, event);\n    }\n\n    return agg;\n  }, Object.assign({}, defVal));\n  return schemaEvent;\n}\n\nfunction mapEvents(events, _ref, mapping) {\n  var type = _ref.type,\n      properties = _ref.properties,\n      items = _ref.items;\n\n  if (events.length === 0) {\n    return [(0, _utils.getDefaultValueForSchema)({\n      type: type\n    })];\n  }\n\n  if (!mapping || mapping === null) {\n    if (type === \"string\") {\n      return events.map(function (item) {\n        return (typeof item === \"undefined\" ? \"undefined\" : _typeof(item)) === \"object\" ? item.label : item;\n      });\n    }\n\n    return events;\n  } else if (typeof mapping === \"string\") {\n    return events.map(function (event) {\n      return typeof event === \"string\" ? event : (0, _selectn2.default)(mapping, event);\n    });\n  } else if (typeof mapping === \"function\") {\n    return events.map(function (event) {\n      return mapping(event);\n    });\n  } else if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === \"object\") {\n    var defVal = defaultValue(properties ? properties : items && items.properties ? items.properties : {});\n    var mappedEvents = events.map(function (event) {\n      return mapToObject(event, mapping, defVal);\n    });\n    return mappedEvents;\n  }\n}\n\nfunction mapToSchema(events, schema, mapping) {\n  var schemaEvents = mapEvents(events, schema, mapping);\n  return (0, _utils.isArraySchema)(schema) ? schemaEvents : schemaEvents[0];\n}\n\nfunction mapFromObject(data, mapping, defVal) {\n  return Object.keys(mapping).reduce(function (agg, field) {\n    var eventField = mapping[field];\n\n    if ((typeof eventField === \"undefined\" ? \"undefined\" : _typeof(eventField)) === \"object\") {\n      Object.assign(agg, mapFromObject(data[field], mapping, {}));\n    } else {\n      if (data[field]) {\n        agg[eventField] = data[field];\n      }\n    }\n\n    return agg;\n  }, defVal);\n}\n/**\n *\n * @param {*} data\n * @param {*} mapping\n * Mapped object is converted to the object mapping takes\n */\n\n\nfunction mapFromSchema(data, mapping) {\n  if (isEmpty(data)) {\n    return;\n  }\n\n  if (!mapping || mapping === null) {\n    return data;\n  } else if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === mapping) {\n    return _defineProperty({}, mapping, data);\n  } else if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === \"object\") {\n    return mapFromObject(data, mapping, {});\n  } else {\n    return data;\n  }\n}\n\nfunction isEmpty(obj) {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\n\nfunction toSelected(formData, schema, mapping, options) {\n  var normFormData = formData ? (0, _utils.toArray)(formData) : [];\n\n  if ((0, _utils.isObjectSchema)(schema)) {\n    return normFormData.map(function (selected) {\n      return mapFromSchema(selected, mapping);\n    }).filter(function (x) {\n      return x !== undefined;\n    });\n  } else if (options && ((0, _utils.isStringSchema)(schema) || (0, _utils.isNumberSchema)(schema)) && typeof mapping === \"string\") {\n    return normFormData.map(function (dataItem) {\n      return options.find(function (option) {\n        if (option[mapping] === dataItem) {\n          return option;\n        }\n      });\n    }).filter(function (x) {\n      return x !== undefined;\n    });\n  } else if ((0, _utils.isArraySchema)(schema)) {\n    return normFormData.map(function (dataItem) {\n      if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === \"object\") {\n        return mapFromSchema(dataItem, mapping);\n      }\n\n      if (options) {\n        return options.find(function (option) {\n          if (option[mapping] === dataItem) {\n            return option;\n          }\n        });\n      } else {\n        return dataItem;\n      }\n    }).filter(function (x) {\n      return x !== undefined;\n    });\n  } else {\n    return normFormData;\n  }\n}\n\nfunction isFunction(functionToCheck) {\n  return functionToCheck instanceof Function;\n}\n/*\n this is done to prevent an edge case with a typeahead wrapped inside a table that has an item selected & uses a function as a labelKey\n TODO: Need to find a better solution for this\n */\n\n\nfunction transformLabelKey(labelKey, schema, selected) {\n  if (isFunction(labelKey) && selected && selected.length > 0 && schema.type === \"string\" && selected.every(function (x) {\n    return typeof x === \"string\" || x instanceof String;\n  })) {\n    return \"\";\n  } else {\n    return labelKey;\n  }\n}\n\nvar BaseTypeaheadField = function (_Component) {\n  _inherits(BaseTypeaheadField, _Component);\n\n  function BaseTypeaheadField() {\n    var _ref3;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, BaseTypeaheadField);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref3 = BaseTypeaheadField.__proto__ || Object.getPrototypeOf(BaseTypeaheadField)).call.apply(_ref3, [this].concat(args))), _this), _this.handleSelectionChange = function (conf) {\n      return function (events) {\n        var mapping = conf.mapping,\n            _conf$cleanAfterSelec = conf.cleanAfterSelection,\n            cleanAfterSelection = _conf$cleanAfterSelec === undefined ? false : _conf$cleanAfterSelec;\n        var schema = _this.props.schema;\n\n        _this.setState({\n          selected: events\n        });\n\n        if (events.length > 0) {\n          var schemaEvents = mapToSchema(events, schema, mapping);\n\n          _this.props.onChange(schemaEvents);\n\n          if (cleanAfterSelection) {\n            setTimeout(function () {\n              if (_this.refs.typeahead) {\n                _this.refs.typeahead.getInstance().clear();\n              }\n            }, 0);\n          }\n        }\n      };\n    }, _this.handleBlur = function () {\n      var selected = _this.state.selected;\n\n      if (selected.length === 0) {\n        _this.setState({\n          selected: []\n        });\n\n        if (_this.refs.typeahead) {\n          _this.refs.typeahead.getInstance() && _this.refs.typeahead.getInstance().clear();\n        } // let onChangeValue = getDefaultValueForSchema(schema);\n        // remove the field if the value is empty\n\n\n        _this.props.onChange(undefined);\n      }\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(BaseTypeaheadField, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _props$uiSchema$focus = this.props.uiSchema.focusOnMount,\n          focusOnMount = _props$uiSchema$focus === undefined ? false : _props$uiSchema$focus;\n\n      if (focusOnMount) {\n        this.refs.typeahead.getInstance().focus();\n      }\n    }\n  }]);\n\n  return BaseTypeaheadField;\n}(_react.Component);\n\nfunction isValidFormData(data) {\n  return data && !isEmpty(data);\n}\n\nvar TypeaheadField = exports.TypeaheadField = function (_BaseTypeaheadField) {\n  _inherits(TypeaheadField, _BaseTypeaheadField);\n\n  function TypeaheadField(props) {\n    _classCallCheck(this, TypeaheadField);\n\n    var _this2 = _possibleConstructorReturn(this, (TypeaheadField.__proto__ || Object.getPrototypeOf(TypeaheadField)).call(this, props));\n\n    var _this2$props = _this2.props,\n        schema = _this2$props.schema,\n        typeahead = _this2$props.uiSchema.typeahead,\n        formData = _this2$props.formData;\n    _this2.state = {\n      selected: isValidFormData(formData) ? toSelected(formData, schema, typeahead.mapping, typeahead.options) : []\n    };\n    return _this2;\n  }\n\n  _createClass(TypeaheadField, [{\n    key: \"render\",\n    value: function render() {\n      var _props = this.props,\n          typeahead = _props.uiSchema.typeahead,\n          _props$idSchema = _props.idSchema;\n      _props$idSchema = _props$idSchema === undefined ? {} : _props$idSchema;\n      var $id = _props$idSchema.$id,\n          schema = _props.schema;\n      var labelKey = mapLabelKey(typeahead.labelKey); // if something is already selected and is a string - removing the label key so that the labelKey function can be ignored.\n\n      labelKey = transformLabelKey(labelKey, schema, this.state.selected);\n      var typeConf = Object.assign({}, DEFAULT_OPTIONS, typeahead, {\n        onChange: this.handleSelectionChange(typeahead),\n        labelKey: labelKey,\n        selected: this.state.selected,\n        onBlur: this.handleBlur\n      });\n      return _react2.default.createElement(\"div\", {\n        id: $id\n      }, _react2.default.createElement(_Label.DefaultLabel, this.props), _react2.default.createElement(_reactBootstrapTypeahead.Typeahead, typeConf));\n    }\n  }]);\n\n  return TypeaheadField;\n}(BaseTypeaheadField);\n\nTypeaheadField.propTypes = {\n  schema: _propTypes2.default.object.isRequired,\n  uiSchema: _propTypes2.default.shape({\n    focusOnMount: _propTypes2.default.bool,\n    typeahead: _propTypes2.default.shape({\n      options: _propTypes2.default.array.isRequired,\n      mapping: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string, _propTypes2.default.object]),\n      cleanAfterSelection: _propTypes2.default.bool\n    }).isRequired\n  }).isRequired\n};\n\nvar AsyncTypeaheadField = exports.AsyncTypeaheadField = function (_BaseTypeaheadField2) {\n  _inherits(AsyncTypeaheadField, _BaseTypeaheadField2);\n\n  function AsyncTypeaheadField(props) {\n    _classCallCheck(this, AsyncTypeaheadField);\n\n    var _this3 = _possibleConstructorReturn(this, (AsyncTypeaheadField.__proto__ || Object.getPrototypeOf(AsyncTypeaheadField)).call(this, props));\n\n    _this3.handleSearch = function (query) {\n      if (!query) {\n        return;\n      }\n\n      var _this3$props$uiSchema = _this3.props.uiSchema.asyncTypeahead,\n          url = _this3$props$uiSchema.url,\n          optionsPath = _this3$props$uiSchema.optionsPath,\n          _this3$props$uiSchema2 = _this3$props$uiSchema.search,\n          search = _this3$props$uiSchema2 === undefined ? function (url, query) {\n        return fetch(url + \"?query=\" + query).then(function (res) {\n          return res.json();\n        });\n      } : _this3$props$uiSchema2;\n\n      _this3.setState({\n        isLoading: true\n      });\n\n      search(url, query).then(function (json) {\n        return optionsPath ? (0, _selectn2.default)(optionsPath, json) : json;\n      }).then(function (options) {\n        return _this3.setState({\n          options: options,\n          isLoading: false\n        });\n      });\n    };\n\n    _this3.handleOnFocus = function () {\n      var _this3$props$uiSchema3 = _this3.props.uiSchema.asyncTypeahead,\n          url = _this3$props$uiSchema3.url,\n          optionsPath = _this3$props$uiSchema3.optionsPath,\n          _this3$props$uiSchema4 = _this3$props$uiSchema3.queryOnFocus,\n          queryOnFocus = _this3$props$uiSchema4 === undefined ? \"\" : _this3$props$uiSchema4,\n          minLength = _this3$props$uiSchema3.minLength,\n          _this3$props$uiSchema5 = _this3$props$uiSchema3.search,\n          search = _this3$props$uiSchema5 === undefined ? function (url, query) {\n        return fetch(url + \"?query=\" + query).then(function (res) {\n          return res.json();\n        });\n      } : _this3$props$uiSchema5;\n\n      if (minLength === 0) {\n        _this3.setState({\n          isLoading: true\n        });\n\n        search(url, queryOnFocus).then(function (json) {\n          return optionsPath ? (0, _selectn2.default)(optionsPath, json) : json;\n        }).then(function (options) {\n          return _this3.setState({\n            options: options,\n            isLoading: false\n          });\n        });\n      }\n    };\n\n    var _this3$props = _this3.props,\n        schema = _this3$props.schema,\n        asyncTypeahead = _this3$props.uiSchema.asyncTypeahead,\n        formData = _this3$props.formData;\n    _this3.state = {\n      options: [],\n      isLoading: false,\n      selected: isValidFormData(formData) ? toSelected(formData, schema, asyncTypeahead.mapping) : []\n    };\n    return _this3;\n  }\n\n  _createClass(AsyncTypeaheadField, [{\n    key: \"render\",\n    value: function render() {\n      var _props2 = this.props,\n          asyncTypeahead = _props2.uiSchema.asyncTypeahead,\n          _props2$idSchema = _props2.idSchema;\n      _props2$idSchema = _props2$idSchema === undefined ? {} : _props2$idSchema;\n      var $id = _props2$idSchema.$id,\n          schema = _props2.schema;\n      var labelKey = mapLabelKey(asyncTypeahead.labelKey); // if something is already selected and is a string - removing the label key so that the labelKey function can be ignored.\n\n      labelKey = transformLabelKey(labelKey, schema, this.state.selected);\n      var typeConf = Object.assign({}, DEFAULT_OPTIONS, asyncTypeahead, {\n        selected: this.state.selected,\n        isLoading: this.state.isLoading,\n        labelKey: labelKey,\n        onChange: this.handleSelectionChange(asyncTypeahead),\n        onSearch: this.handleSearch,\n        options: this.state.options,\n        onFocus: this.handleOnFocus,\n        onBlur: this.handleBlur\n      });\n\n      if (asyncTypeahead.overrideOptions) {\n        typeConf.onInputChange = this.props.onChange;\n      }\n\n      return _react2.default.createElement(\"div\", {\n        id: $id\n      }, _react2.default.createElement(_Label.DefaultLabel, this.props), _react2.default.createElement(_reactBootstrapTypeahead.AsyncTypeahead, typeConf));\n    }\n  }]);\n\n  return AsyncTypeaheadField;\n}(BaseTypeaheadField);\n\nAsyncTypeaheadField.propTypes = {\n  schema: _propTypes2.default.object.isRequired,\n  uiSchema: _propTypes2.default.shape({\n    focusOnMount: _propTypes2.default.bool,\n    asyncTypeahead: _propTypes2.default.shape({\n      url: _propTypes2.default.string,\n      optionsPath: _propTypes2.default.string,\n      mapping: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string, _propTypes2.default.object]),\n      cleanAfterSelection: _propTypes2.default.bool,\n      overrideOptions: _propTypes2.default.bool,\n      search: _propTypes2.default.func\n    }).isRequired\n  })\n};","map":{"version":3,"sources":["/Users/lucaspauker/projects/treehacks/meet/node_modules/react-jsonschema-form-extras/lib/TypeaheadField.js"],"names":["Object","defineProperty","exports","value","AsyncTypeaheadField","TypeaheadField","undefined","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_typeof","Symbol","iterator","obj","constructor","mapToSchema","mapFromSchema","toSelected","_react","require","_react2","_interopRequireDefault","_propTypes","_propTypes2","_reactBootstrapTypeahead","_utils","_selectn","_selectn2","_Label","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","_defineProperty","DEFAULT_OPTIONS","required","labelKey","minLength","placeholder","ref","optionToString","fields","separator","option","map","field","filter","fieldVal","reduce","agg","Array","isArray","mapLabelKey","defaultValue","properties","defVal","keys","mapToObject","event","mapping","schemaEvent","eventField","assign","mapEvents","events","_ref","type","items","getDefaultValueForSchema","item","label","mappedEvents","schema","schemaEvents","isArraySchema","mapFromObject","data","isEmpty","formData","options","normFormData","toArray","isObjectSchema","selected","x","isStringSchema","isNumberSchema","dataItem","find","isFunction","functionToCheck","Function","transformLabelKey","every","String","BaseTypeaheadField","_Component","_ref3","_temp","_this","_ret","_len","arguments","args","_key","getPrototypeOf","apply","concat","handleSelectionChange","conf","_conf$cleanAfterSelec","cleanAfterSelection","setState","onChange","setTimeout","refs","typeahead","getInstance","clear","handleBlur","state","componentDidMount","_props$uiSchema$focus","uiSchema","focusOnMount","focus","Component","isValidFormData","_BaseTypeaheadField","_this2","_this2$props","render","_props","_props$idSchema","idSchema","$id","typeConf","onBlur","createElement","id","DefaultLabel","Typeahead","propTypes","object","isRequired","shape","bool","array","oneOfType","func","string","_BaseTypeaheadField2","_this3","handleSearch","query","_this3$props$uiSchema","asyncTypeahead","url","optionsPath","_this3$props$uiSchema2","search","fetch","then","res","json","isLoading","handleOnFocus","_this3$props$uiSchema3","_this3$props$uiSchema4","queryOnFocus","_this3$props$uiSchema5","_this3$props","_props2","_props2$idSchema","onSearch","onFocus","overrideOptions","onInputChange","AsyncTypeahead"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AsyncTypeaheadField = exports.TypeaheadField = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.mapToSchema = mapToSchema;\nexports.mapFromSchema = mapFromSchema;\nexports.toSelected = toSelected;\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactBootstrapTypeahead = require(\"react-bootstrap-typeahead\");\n\nvar _utils = require(\"./utils\");\n\nvar _selectn = require(\"selectn\");\n\nvar _selectn2 = _interopRequireDefault(_selectn);\n\nvar _Label = require(\"./Label\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar DEFAULT_OPTIONS = {\n  required: false,\n  labelKey: \"name\",\n  minLength: 3,\n  placeholder: \"Search...\",\n  ref: \"typeahead\"\n};\n\nfunction optionToString(fields, separator) {\n  return function (option) {\n    return fields.map(function (field) {\n      return (0, _selectn2.default)(field, option);\n    }).filter(function (fieldVal) {\n      return fieldVal;\n    }).reduce(function (agg, fieldVal, i) {\n      if (i === 0) {\n        return fieldVal;\n      } else {\n        if (Array.isArray(separator)) {\n          return \"\" + agg + separator[i - 1] + fieldVal;\n        }\n        return \"\" + agg + separator + fieldVal;\n      }\n    }, \"\");\n  };\n}\n\nfunction mapLabelKey(labelKey) {\n  if (Array.isArray(labelKey)) {\n    return optionToString(labelKey, \" \");\n  } else if ((typeof labelKey === \"undefined\" ? \"undefined\" : _typeof(labelKey)) === \"object\" && labelKey.fields && labelKey.separator) {\n    var fields = labelKey.fields,\n        separator = labelKey.separator;\n\n    return optionToString(fields, separator);\n  }\n  return labelKey;\n}\n\nfunction defaultValue(properties) {\n  var defVal = Object.keys(properties).reduce(function (agg, field) {\n    if (properties[field].default !== undefined) {\n      agg[field] = properties[field].default;\n    }\n    return agg;\n  }, {});\n  return defVal;\n}\n\nfunction mapToObject(event, mapping, defVal) {\n  var schemaEvent = Object.keys(mapping).reduce(function (agg, field) {\n    var eventField = mapping[field];\n    if ((typeof eventField === \"undefined\" ? \"undefined\" : _typeof(eventField)) === \"object\") {\n      agg[field] = mapToObject(event, eventField, {});\n    } else {\n      agg[field] = (0, _selectn2.default)(eventField, event);\n    }\n    return agg;\n  }, Object.assign({}, defVal));\n  return schemaEvent;\n}\n\nfunction mapEvents(events, _ref, mapping) {\n  var type = _ref.type,\n      properties = _ref.properties,\n      items = _ref.items;\n\n  if (events.length === 0) {\n    return [(0, _utils.getDefaultValueForSchema)({ type: type })];\n  }\n  if (!mapping || mapping === null) {\n    if (type === \"string\") {\n      return events.map(function (item) {\n        return (typeof item === \"undefined\" ? \"undefined\" : _typeof(item)) === \"object\" ? item.label : item;\n      });\n    }\n    return events;\n  } else if (typeof mapping === \"string\") {\n    return events.map(function (event) {\n      return typeof event === \"string\" ? event : (0, _selectn2.default)(mapping, event);\n    });\n  } else if (typeof mapping === \"function\") {\n    return events.map(function (event) {\n      return mapping(event);\n    });\n  } else if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === \"object\") {\n    var defVal = defaultValue(properties ? properties : items && items.properties ? items.properties : {});\n    var mappedEvents = events.map(function (event) {\n      return mapToObject(event, mapping, defVal);\n    });\n\n    return mappedEvents;\n  }\n}\n\nfunction mapToSchema(events, schema, mapping) {\n  var schemaEvents = mapEvents(events, schema, mapping);\n  return (0, _utils.isArraySchema)(schema) ? schemaEvents : schemaEvents[0];\n}\n\nfunction mapFromObject(data, mapping, defVal) {\n  return Object.keys(mapping).reduce(function (agg, field) {\n    var eventField = mapping[field];\n    if ((typeof eventField === \"undefined\" ? \"undefined\" : _typeof(eventField)) === \"object\") {\n      Object.assign(agg, mapFromObject(data[field], mapping, {}));\n    } else {\n      if (data[field]) {\n        agg[eventField] = data[field];\n      }\n    }\n    return agg;\n  }, defVal);\n}\n/**\n *\n * @param {*} data\n * @param {*} mapping\n * Mapped object is converted to the object mapping takes\n */\nfunction mapFromSchema(data, mapping) {\n  if (isEmpty(data)) {\n    return;\n  }\n  if (!mapping || mapping === null) {\n    return data;\n  } else if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === mapping) {\n    return _defineProperty({}, mapping, data);\n  } else if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === \"object\") {\n    return mapFromObject(data, mapping, {});\n  } else {\n    return data;\n  }\n}\n\nfunction isEmpty(obj) {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\n\nfunction toSelected(formData, schema, mapping, options) {\n  var normFormData = formData ? (0, _utils.toArray)(formData) : [];\n  if ((0, _utils.isObjectSchema)(schema)) {\n    return normFormData.map(function (selected) {\n      return mapFromSchema(selected, mapping);\n    }).filter(function (x) {\n      return x !== undefined;\n    });\n  } else if (options && ((0, _utils.isStringSchema)(schema) || (0, _utils.isNumberSchema)(schema)) && typeof mapping === \"string\") {\n    return normFormData.map(function (dataItem) {\n      return options.find(function (option) {\n        if (option[mapping] === dataItem) {\n          return option;\n        }\n      });\n    }).filter(function (x) {\n      return x !== undefined;\n    });\n  } else if ((0, _utils.isArraySchema)(schema)) {\n    return normFormData.map(function (dataItem) {\n      if ((typeof mapping === \"undefined\" ? \"undefined\" : _typeof(mapping)) === \"object\") {\n        return mapFromSchema(dataItem, mapping);\n      }\n      if (options) {\n        return options.find(function (option) {\n          if (option[mapping] === dataItem) {\n            return option;\n          }\n        });\n      } else {\n        return dataItem;\n      }\n    }).filter(function (x) {\n      return x !== undefined;\n    });\n  } else {\n    return normFormData;\n  }\n}\n\nfunction isFunction(functionToCheck) {\n  return functionToCheck instanceof Function;\n}\n\n/*\n this is done to prevent an edge case with a typeahead wrapped inside a table that has an item selected & uses a function as a labelKey\n TODO: Need to find a better solution for this\n */\nfunction transformLabelKey(labelKey, schema, selected) {\n  if (isFunction(labelKey) && selected && selected.length > 0 && schema.type === \"string\" && selected.every(function (x) {\n    return typeof x === \"string\" || x instanceof String;\n  })) {\n    return \"\";\n  } else {\n    return labelKey;\n  }\n}\n\nvar BaseTypeaheadField = function (_Component) {\n  _inherits(BaseTypeaheadField, _Component);\n\n  function BaseTypeaheadField() {\n    var _ref3;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, BaseTypeaheadField);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref3 = BaseTypeaheadField.__proto__ || Object.getPrototypeOf(BaseTypeaheadField)).call.apply(_ref3, [this].concat(args))), _this), _this.handleSelectionChange = function (conf) {\n      return function (events) {\n        var mapping = conf.mapping,\n            _conf$cleanAfterSelec = conf.cleanAfterSelection,\n            cleanAfterSelection = _conf$cleanAfterSelec === undefined ? false : _conf$cleanAfterSelec;\n        var schema = _this.props.schema;\n\n\n        _this.setState({\n          selected: events\n        });\n\n        if (events.length > 0) {\n          var schemaEvents = mapToSchema(events, schema, mapping);\n          _this.props.onChange(schemaEvents);\n          if (cleanAfterSelection) {\n            setTimeout(function () {\n              if (_this.refs.typeahead) {\n                _this.refs.typeahead.getInstance().clear();\n              }\n            }, 0);\n          }\n        }\n      };\n    }, _this.handleBlur = function () {\n      var selected = _this.state.selected;\n\n\n      if (selected.length === 0) {\n        _this.setState({\n          selected: []\n        });\n        if (_this.refs.typeahead) {\n          _this.refs.typeahead.getInstance() && _this.refs.typeahead.getInstance().clear();\n        }\n        // let onChangeValue = getDefaultValueForSchema(schema);\n        // remove the field if the value is empty\n        _this.props.onChange(undefined);\n      }\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(BaseTypeaheadField, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _props$uiSchema$focus = this.props.uiSchema.focusOnMount,\n          focusOnMount = _props$uiSchema$focus === undefined ? false : _props$uiSchema$focus;\n\n      if (focusOnMount) {\n        this.refs.typeahead.getInstance().focus();\n      }\n    }\n  }]);\n\n  return BaseTypeaheadField;\n}(_react.Component);\n\nfunction isValidFormData(data) {\n  return data && !isEmpty(data);\n}\n\nvar TypeaheadField = exports.TypeaheadField = function (_BaseTypeaheadField) {\n  _inherits(TypeaheadField, _BaseTypeaheadField);\n\n  function TypeaheadField(props) {\n    _classCallCheck(this, TypeaheadField);\n\n    var _this2 = _possibleConstructorReturn(this, (TypeaheadField.__proto__ || Object.getPrototypeOf(TypeaheadField)).call(this, props));\n\n    var _this2$props = _this2.props,\n        schema = _this2$props.schema,\n        typeahead = _this2$props.uiSchema.typeahead,\n        formData = _this2$props.formData;\n\n\n    _this2.state = {\n      selected: isValidFormData(formData) ? toSelected(formData, schema, typeahead.mapping, typeahead.options) : []\n    };\n    return _this2;\n  }\n\n  _createClass(TypeaheadField, [{\n    key: \"render\",\n    value: function render() {\n      var _props = this.props,\n          typeahead = _props.uiSchema.typeahead,\n          _props$idSchema = _props.idSchema;\n      _props$idSchema = _props$idSchema === undefined ? {} : _props$idSchema;\n      var $id = _props$idSchema.$id,\n          schema = _props.schema;\n\n\n      var labelKey = mapLabelKey(typeahead.labelKey);\n      // if something is already selected and is a string - removing the label key so that the labelKey function can be ignored.\n      labelKey = transformLabelKey(labelKey, schema, this.state.selected);\n\n      var typeConf = Object.assign({}, DEFAULT_OPTIONS, typeahead, {\n        onChange: this.handleSelectionChange(typeahead),\n        labelKey: labelKey,\n        selected: this.state.selected,\n        onBlur: this.handleBlur\n      });\n\n      return _react2.default.createElement(\n        \"div\",\n        { id: $id },\n        _react2.default.createElement(_Label.DefaultLabel, this.props),\n        _react2.default.createElement(_reactBootstrapTypeahead.Typeahead, typeConf)\n      );\n    }\n  }]);\n\n  return TypeaheadField;\n}(BaseTypeaheadField);\n\nTypeaheadField.propTypes = {\n  schema: _propTypes2.default.object.isRequired,\n  uiSchema: _propTypes2.default.shape({\n    focusOnMount: _propTypes2.default.bool,\n    typeahead: _propTypes2.default.shape({\n      options: _propTypes2.default.array.isRequired,\n      mapping: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string, _propTypes2.default.object]),\n      cleanAfterSelection: _propTypes2.default.bool\n    }).isRequired\n  }).isRequired\n};\n\nvar AsyncTypeaheadField = exports.AsyncTypeaheadField = function (_BaseTypeaheadField2) {\n  _inherits(AsyncTypeaheadField, _BaseTypeaheadField2);\n\n  function AsyncTypeaheadField(props) {\n    _classCallCheck(this, AsyncTypeaheadField);\n\n    var _this3 = _possibleConstructorReturn(this, (AsyncTypeaheadField.__proto__ || Object.getPrototypeOf(AsyncTypeaheadField)).call(this, props));\n\n    _this3.handleSearch = function (query) {\n      if (!query) {\n        return;\n      }\n\n      var _this3$props$uiSchema = _this3.props.uiSchema.asyncTypeahead,\n          url = _this3$props$uiSchema.url,\n          optionsPath = _this3$props$uiSchema.optionsPath,\n          _this3$props$uiSchema2 = _this3$props$uiSchema.search,\n          search = _this3$props$uiSchema2 === undefined ? function (url, query) {\n        return fetch(url + \"?query=\" + query).then(function (res) {\n          return res.json();\n        });\n      } : _this3$props$uiSchema2;\n\n\n      _this3.setState({ isLoading: true });\n\n      search(url, query).then(function (json) {\n        return optionsPath ? (0, _selectn2.default)(optionsPath, json) : json;\n      }).then(function (options) {\n        return _this3.setState({ options: options, isLoading: false });\n      });\n    };\n\n    _this3.handleOnFocus = function () {\n      var _this3$props$uiSchema3 = _this3.props.uiSchema.asyncTypeahead,\n          url = _this3$props$uiSchema3.url,\n          optionsPath = _this3$props$uiSchema3.optionsPath,\n          _this3$props$uiSchema4 = _this3$props$uiSchema3.queryOnFocus,\n          queryOnFocus = _this3$props$uiSchema4 === undefined ? \"\" : _this3$props$uiSchema4,\n          minLength = _this3$props$uiSchema3.minLength,\n          _this3$props$uiSchema5 = _this3$props$uiSchema3.search,\n          search = _this3$props$uiSchema5 === undefined ? function (url, query) {\n        return fetch(url + \"?query=\" + query).then(function (res) {\n          return res.json();\n        });\n      } : _this3$props$uiSchema5;\n\n\n      if (minLength === 0) {\n        _this3.setState({ isLoading: true });\n        search(url, queryOnFocus).then(function (json) {\n          return optionsPath ? (0, _selectn2.default)(optionsPath, json) : json;\n        }).then(function (options) {\n          return _this3.setState({ options: options, isLoading: false });\n        });\n      }\n    };\n\n    var _this3$props = _this3.props,\n        schema = _this3$props.schema,\n        asyncTypeahead = _this3$props.uiSchema.asyncTypeahead,\n        formData = _this3$props.formData;\n\n\n    _this3.state = {\n      options: [],\n      isLoading: false,\n      selected: isValidFormData(formData) ? toSelected(formData, schema, asyncTypeahead.mapping) : []\n    };\n    return _this3;\n  }\n\n  _createClass(AsyncTypeaheadField, [{\n    key: \"render\",\n    value: function render() {\n      var _props2 = this.props,\n          asyncTypeahead = _props2.uiSchema.asyncTypeahead,\n          _props2$idSchema = _props2.idSchema;\n      _props2$idSchema = _props2$idSchema === undefined ? {} : _props2$idSchema;\n      var $id = _props2$idSchema.$id,\n          schema = _props2.schema;\n\n\n      var labelKey = mapLabelKey(asyncTypeahead.labelKey);\n      // if something is already selected and is a string - removing the label key so that the labelKey function can be ignored.\n      labelKey = transformLabelKey(labelKey, schema, this.state.selected);\n\n      var typeConf = Object.assign({}, DEFAULT_OPTIONS, asyncTypeahead, {\n        selected: this.state.selected,\n        isLoading: this.state.isLoading,\n        labelKey: labelKey,\n        onChange: this.handleSelectionChange(asyncTypeahead),\n        onSearch: this.handleSearch,\n        options: this.state.options,\n        onFocus: this.handleOnFocus,\n        onBlur: this.handleBlur\n      });\n\n      if (asyncTypeahead.overrideOptions) {\n        typeConf.onInputChange = this.props.onChange;\n      }\n\n      return _react2.default.createElement(\n        \"div\",\n        { id: $id },\n        _react2.default.createElement(_Label.DefaultLabel, this.props),\n        _react2.default.createElement(_reactBootstrapTypeahead.AsyncTypeahead, typeConf)\n      );\n    }\n  }]);\n\n  return AsyncTypeaheadField;\n}(BaseTypeaheadField);\n\nAsyncTypeaheadField.propTypes = {\n  schema: _propTypes2.default.object.isRequired,\n  uiSchema: _propTypes2.default.shape({\n    focusOnMount: _propTypes2.default.bool,\n    asyncTypeahead: _propTypes2.default.shape({\n      url: _propTypes2.default.string,\n      optionsPath: _propTypes2.default.string,\n      mapping: _propTypes2.default.oneOfType([_propTypes2.default.func, _propTypes2.default.string, _propTypes2.default.object]),\n      cleanAfterSelection: _propTypes2.default.bool,\n      overrideOptions: _propTypes2.default.bool,\n      search: _propTypes2.default.func\n    }).isRequired\n  })\n};"]},"metadata":{},"sourceType":"script"}